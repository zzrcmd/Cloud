<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>吉吉-Cloud 资源中心</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
  --primary-color: #2c3e50;
  --secondary-color: #3498db;
  --accent-color: #e74c3c;
  --success-color: #2ecc71;
  --text-color: #34495e;
  --light-bg: #f8f9fa;
  --card-bg: #ffffff;
  --border-color: #e0e0e0;
  --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  --announcement-color: #fff3cd;
  --dark-bg: #1a1a1a;
  --dark-card: #2a2a2a;
  --dark-text: #e0e0e0;
  --dark-border: #333333;
  --box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
  --box-shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.15);
  --border-radius: 12px;
  --transition: all 0.3s ease;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-main);
  background-color: var(--light-bg);
  margin: 0;
  padding: 20px;
  color: var(--text-color);
  line-height: 1.6;
  transition: var(--transition);
  background-image: linear-gradient(135deg, #f5f7fa 0%, #e4e7f1 100%);
  min-height: 100vh;
}

body[data-theme="dark"] {
  background-color: var(--dark-bg);
  color: var(--dark-text);
  background-image: linear-gradient(135deg, #1e1e2a 0%, #121218 100%);
}

.container {
  max-width: 1300px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: 1fr;
  gap: 30px;
  padding-bottom: 30px;
}

@media (min-width: 768px) {
  .container {
    grid-template-columns: 1fr 1fr;
  }
}

@media (min-width: 1200px) {
  .container {
    grid-template-columns: 1.2fr 0.8fr;
  }
}

header {
  grid-column: 1 / -1;
  text-align: center;
  margin: 20px 0 30px;
  position: relative;
}

.logo {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  margin-bottom: 10px;
}

.logo-icon {
  background: linear-gradient(135deg, var(--secondary-color), #1a5276);
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: var(--box-shadow);
}

.logo-icon i {
  font-size: 28px;
  color: white;
}

h1 {
  color: var(--primary-color);
  font-size: 2.8rem;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 10px;
  text-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.subtitle {
  color: var(--text-color);
  font-size: 1.1rem;
  max-width: 600px;
  margin: 0 auto;
  opacity: 0.8;
}

body[data-theme="dark"] h1 {
  background: linear-gradient(135deg, var(--dark-text), #7fdbff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

body[data-theme="dark"] .subtitle {
  color: var(--dark-text);
}

.theme-switcher {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 1000;
  display: flex;
  gap: 10px;
}

.theme-button {
  background: linear-gradient(135deg, var(--secondary-color), #1a5276);
  color: white;
  padding: 10px 20px;
  border-radius: 30px;
  border: none;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
  box-shadow: var(--box-shadow);
}

.theme-button:hover {
  transform: translateY(-2px);
  box-shadow: var(--box-shadow-hover);
}

.announcement-section {
  grid-column: 1 / -1;
  background: var(--announcement-color);
  padding: 25px;
  border-radius: var(--border-radius);
  border: 2px solid #ffecb5;
  margin-bottom: 20px;
  position: relative;
  overflow: hidden;
  box-shadow: var(--box-shadow);
}

.announcement-section::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 8px;
  height: 100%;
  background: linear-gradient(to bottom, #ffc107, #ff9800);
}

body[data-theme="dark"] .announcement-section {
  background: #2d2d2d;
  border-color: #444;
}

.announcement-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.announcement-title {
  color: #856404;
  margin: 0;
  font-size: 1.5rem;
  display: flex;
  align-items: center;
  gap: 10px;
}

.refresh-button {
  background: rgba(255, 255, 255, 0.3);
  border: 1px solid #856404;
  color: #856404;
  padding: 8px 15px;
  border-radius: 6px;
  cursor: pointer;
  transition: var(--transition);
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 6px;
}

.refresh-button:hover {
  background: #856404;
  color: white;
}

.release-section, .discussion-section {
  background: var(--card-bg);
  padding: 25px;
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  transition: var(--transition);
}

.release-section:hover, .discussion-section:hover {
  box-shadow: var(--box-shadow-hover);
}

body[data-theme="dark"] .release-section,
body[data-theme="dark"] .discussion-section {
  background-color: var(--dark-card);
  border: 1px solid var(--dark-border);
}

.section-title {
  color: var(--secondary-color);
  border-bottom: 2px solid var(--secondary-color);
  padding-bottom: 15px;
  margin-top: 0;
  margin-bottom: 20px;
  font-size: 1.8rem;
  display: flex;
  align-items: center;
  gap: 12px;
}

.section-title i {
  font-size: 1.4rem;
}

.release {
  background-color: var(--light-bg);
  padding: 20px;
  margin: 20px 0;
  border-radius: 10px;
  border: 1px solid var(--border-color);
  transition: var(--transition);
}

.release:hover {
  transform: translateY(-3px);
  box-shadow: var(--box-shadow);
}

.release-header h3 {
  color: var(--primary-color);
  margin-bottom: 10px;
  font-size: 1.3rem;
}

.release-meta {
  display: flex;
  gap: 20px;
  color: #7f8c8d;
  margin-bottom: 15px;
  font-size: 0.95rem;
}

.download-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  margin: 12px 0;
  background: var(--card-bg);
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  border: 1px solid var(--border-color);
  transition: var(--transition);
}

.download-item:hover {
  transform: translateX(5px);
  border-left: 4px solid var(--secondary-color);
}

.file-info {
  flex: 1;
}

.file-name {
  font-weight: 600;
  display: block;
  margin-bottom: 6px;
  font-size: 1.1rem;
  color: var(--primary-color);
}

.file-size {
  color: #7f8c8d;
  font-size: 0.9rem;
}

.download-options {
  display: flex;
  gap: 12px;
}

.download-link {
  padding: 10px 18px;
  border-radius: 6px;
  text-decoration: none;
  transition: var(--transition);
  font-size: 0.95rem;
  font-weight: 500;
  white-space: nowrap;
  display: flex;
  align-items: center;
  gap: 6px;
}

.download-link:not(.accelerated) {
  background: #f0f0f0;
  color: var(--primary-color);
  border: 1px solid #ddd;
}

.download-link:not(.accelerated):hover {
  background: #e0e0e0;
}

.download-link.accelerated {
  background: linear-gradient(135deg, var(--secondary-color), #1a5276);
  color: white;
  border: 1px solid var(--secondary-color);
}

.download-link.accelerated:hover {
  background: linear-gradient(135deg, #1a5276, var(--secondary-color));
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
}

.toggle-assets {
  background: linear-gradient(135deg, var(--secondary-color), #1a5276);
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-family: inherit;
  font-weight: 600;
  transition: var(--transition);
  margin-top: 15px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.toggle-assets:hover {
  transform: translateY(-2px);
  box-shadow: var(--box-shadow);
}

.quick-create {
  background: var(--light-bg);
  padding: 25px;
  border-radius: var(--border-radius);
  margin: 25px 0;
  border: 1px solid var(--border-color);
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  transition: var(--transition);
}

.quick-create:hover {
  box-shadow: var(--box-shadow);
}

.form-input, .form-textarea {
  width: 100%;
  padding: 14px;
  margin: 12px 0;
  border: 2px solid var(--border-color);
  border-radius: 8px;
  box-sizing: border-box;
  font-family: inherit;
  transition: var(--transition);
  font-size: 1rem;
  background: var(--card-bg);
  color: var(--text-color);
}

.form-input:focus, .form-textarea:focus {
  border-color: var(--secondary-color);
  outline: none;
  box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
}

.submit-button {
  background: linear-gradient(135deg, var(--secondary-color), #1a5276);
  color: white;
  padding: 12px 28px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-family: inherit;
  font-weight: 600;
  transition: var(--transition);
  font-size: 1rem;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-top: 10px;
}

.submit-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
}

.issue {
  margin: 25px 0;
  padding: 20px;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  transition: var(--transition);
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}

.issue:hover {
  transform: translateY(-3px);
  box-shadow: var(--box-shadow);
}

.user-info {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 15px;
}

.avatar {
  width: 45px;
  height: 45px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--secondary-color);
  padding: 2px;
}

.user-details {
  flex-grow: 1;
}

.comment {
  margin: 18px 0;
  padding: 18px;
  background: var(--light-bg);
  border-radius: 10px;
  display: flex;
  gap: 18px;
  transition: var(--transition);
}

.comment:hover {
  transform: translateX(5px);
  border-left: 3px solid var(--secondary-color);
}

.comment-content {
  flex-grow: 1;
}

.comment-author {
  font-weight: 600;
  color: var(--primary-color);
  font-size: 1.1rem;
}

.comment-date {
  color: #95a5a6;
  font-size: 0.85rem;
  margin-top: 3px;
}

.comments-container {
  margin-top: 20px;
  border-top: 1px solid var(--border-color);
  padding-top: 20px;
}

.disclaimer-section {
  grid-column: 1 / -1;
  margin-top: 40px;
  padding: 25px;
  background: rgba(255, 255, 255, 0.9);
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color);
  font-size: 0.95rem;
  color: #666;
  text-align: center;
  box-shadow: var(--box-shadow);
}

body[data-theme="dark"] .disclaimer-section {
  background: rgba(0, 0, 0, 0.8);
  color: #aaa;
  border-color: var(--dark-border);
}

.disclaimer-link {
  color: var(--secondary-color);
  text-decoration: none;
  font-weight: 600;
  transition: var(--transition);
  border-bottom: 1px dashed var(--secondary-color);
}

.disclaimer-link:hover {
  color: #1a5276;
  border-bottom-style: solid;
}

.loading-text {
  text-align: center;
  color: var(--text-color);
  padding: 30px;
  font-size: 1.1rem;
}

.loading-text i {
  margin-right: 10px;
  animation: spin 1.5s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.stats-bar {
  display: flex;
  justify-content: space-around;
  padding: 15px;
  background: var(--card-bg);
  border-radius: var(--border-radius);
  margin: 25px 0;
  box-shadow: var(--box-shadow);
  grid-column: 1 / -1;
}

.stat-item {
  text-align: center;
  padding: 10px;
}

.stat-value {
  font-size: 2rem;
  font-weight: 700;
  color: var(--secondary-color);
  margin-bottom: 5px;
}

.stat-label {
  color: var(--text-color);
  font-size: 0.95rem;
}

body[data-theme="dark"] .stat-label {
  color: var(--dark-text);
}

.footer {
  grid-column: 1 / -1;
  text-align: center;
  padding: 20px;
  margin-top: 20px;
  color: var(--text-color);
  font-size: 0.9rem;
  border-top: 1px solid var(--border-color);
}

@media (max-width: 768px) {
  body {
    padding: 15px;
  }
  
  h1 {
    font-size: 2.2rem;
  }
  
  .section-title {
    font-size: 1.5rem;
  }
  
  .download-item {
    flex-direction: column;
    align-items: flex-start;
    gap: 15px;
  }

  .download-options {
    width: 100%;
    flex-direction: column;
  }
  
  .download-link {
    width: 100%;
    text-align: center;
    justify-content: center;
  }
  
  .stats-bar {
    flex-direction: column;
    gap: 15px;
  }
  
  .theme-button {
    padding: 8px 15px;
    font-size: 0.9rem;
  }
}
  </style>
</head>
<body>
  <div class="theme-switcher">
    <button class="theme-button" onclick="toggleTheme()">
      <i class="fas fa-moon"></i> 切换主题
    </button>
  </div>

  <header>
    <div class="logo">
      <div class="logo-icon">
        <i class="fas fa-cloud"></i>
      </div>
      <h1>吉吉-Cloud 资源中心</h1>
    </div>
    <p class="subtitle">提供各种最新资源下载与“学习”交流平台</p>
  </header>
  
  <div class="container">
    <div class="announcement-section">
  <div class="announcement-header">
    <h2 class="announcement-title"><i class="fas fa-bullhorn"></i> 系统公告</h2>
    <button class="refresh-button" onclick="fetchAnnouncement()">
      <i class="fas fa-sync-alt"></i> 刷新
    </button>
  </div>
  <div id="announcement-content">
    <div class="loading-text"><i class="fas fa-spinner"></i> 加载公告中...</div>
  </div>
</div>

<div class="stats-bar">
  <div class="stat-item">
    <div class="stat-value" id="release-count">15</div>
    <div class="stat-label">资源发布</div>
  </div>
  <div class="stat-item">
    <div class="stat-value" id="file-count">42</div>
    <div class="stat-label">文件总数</div>
  </div>
  <div class="stat-item">
    <div class="stat-value" id="user-count">128</div>
    <div class="stat-label">活跃用户</div>
  </div>
  <div class="stat-item">
    <div class="stat-value" id="download-count">1.2K</div>
    <div class="stat-label">总下载量</div>
  </div>
</div>

<div class="release-section">
  <h2 class="section-title"><i class="fas fa-box-open"></i> 文件发布</h2>
  <div id="releases">
    <div class="loading-text"><i class="fas fa-spinner"></i> 加载发布文件中...</div>
  </div>
</div>

<div class="discussion-section">
  <h2 class="section-title"><i class="fas fa-comments"></i> 社区讨论</h2>
  <div class="quick-create">
    <h3 style="margin-top:0; color: var(--primary-color);"><i class="fas fa-pen"></i> 新建讨论</h3>
    <input type="text" id="issueTitle" 
           placeholder="输入讨论标题（必填）" 
           class="form-input"
           required>
    <textarea id="issueBody" 
              class="form-textarea"
              placeholder="输入讨论内容（支持Markdown格式）"
              rows="4"></textarea>
    <button onclick="createNewIssue()" 
            class="submit-button">
      <i class="fas fa-plus-circle"></i> 创建讨论
    </button>
  </div>
  <div id="discussions">
    <div class="loading-text"><i class="fas fa-spinner"></i> 加载讨论中...</div>
  </div>
</div>

<section class="disclaimer-section">
  <strong><i class="fas fa-exclamation-circle"></i> 免责声明：</strong>
  本站所有资源均为用户自发上传，不代表本站立场。下载内容仅供学习交流使用，不得用于商业用途。
  使用本站资源产生的一切后果由使用者自行承担，与本站无关。如需删除内容，请联系管理员。
  <a href="/Cloud/disclaimer.html" class="disclaimer-link">查看完整声明</a>
</section>

<div class="footer">
  <p>© 2025 吉吉-Cloud 资源中心 | 为开发者提供高效资源服务</p>
</div>
  </div>

  <script>
    // JavaScript
    // 主题功能
function toggleTheme() {
  const currentTheme = document.body.getAttribute('data-theme') || 'light';
  const newTheme = currentTheme === 'light' ? 'dark' : 'light';
  document.body.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
  updateThemeButton(newTheme);
}

function updateThemeButton(theme) {
  const button = document.querySelector('.theme-button');
  if (theme === 'dark') {
    button.innerHTML = '<i class="fas fa-sun"></i> 浅色模式';
  } else {
    button.innerHTML = '<i class="fas fa-moon"></i> 深色模式';
  }
}

function initTheme() {
  const savedTheme = localStorage.getItem('theme') || 
                    (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
  document.body.setAttribute('data-theme', savedTheme);
  updateThemeButton(savedTheme);
}

// 初始化
async function initialize() {
  initTheme();
  try {
    await Promise.all([
      fetchAnnouncement(),
      fetchReleases(),
      fetchDiscussions()
    ]);
  } catch (error) {
    showErrorNotification(`初始化失败: ${error.message}`);
  }
}

// 公告功能
async function fetchAnnouncement() {
  const contentDiv = document.getElementById('announcement-content');
  try {
    contentDiv.innerHTML = '<div class="loading-text"><i class="fas fa-spinner"></i> 加载中...</div>';
    const response = await fetch('https://raw.githubusercontent.com/zzrcmd/YF-Cloud/main/home.txt');
    if (!response.ok) throw new Error(`HTTP错误! 状态码: ${response.status}`);
    const text = await response.text();
    contentDiv.innerHTML = (text || '暂无公告').replace(/\n/g, '<br>');
  } catch (error) {
    contentDiv.innerHTML = `<div class="error-text">
      <i class="fas fa-exclamation-triangle"></i> ${escapeHtml(error.message)}
      <button onclick="fetchAnnouncement()" class="refresh-button" style="margin-top:10px;">
        <i class="fas fa-redo"></i> 重试
      </button>
    </div>`;
  }
}

// 文件发布功能
async function fetchReleases() {
  try {
    const response = await fetch(`https://api.github.com/repos/zzrcmd/YF-Cloud/releases`);
    if (!response.ok) throw new Error('获取发布信息失败');
    
    const releases = await response.json();
    const container = document.getElementById('releases');
    
    container.innerHTML = releases.map(release => `
      <div class="release">
        <div class="release-header">
          <h3><i class="fas fa-tag"></i> ${escapeHtml(release.name)}</h3>
          <div class="release-meta">
            <span><i class="fas fa-code-branch"></i> 版本：${escapeHtml(release.tag_name)}</span>
            <span><i class="fas fa-calendar-alt"></i> 发布时间：${new Date(release.published_at).toLocaleDateString()}</span>
          </div>
        </div>
        <ul class="assets" style="display:none;">
          ${release.assets.map(asset => `
            <li class="download-item">
              <div class="file-info">
                <span class="file-name"><i class="fas fa-file"></i> ${escapeHtml(asset.name)}</span>
                <span class="file-size"><i class="fas fa-database"></i> ${formatFileSize(asset.size)}</span>
              </div>
              <div class="download-options">
                <a href="${asset.browser_download_url}" class="download-link">
                  <i class="fas fa-download"></i> 普通下载
                </a>
                <a href="${generateProxyUrl(asset.browser_download_url)}" 
                   class="download-link accelerated">
                  <i class="fas fa-bolt"></i> 高速下载
                </a>
              </div>
            </li>
          `).join('')}
        </ul>
        <button class="submit-button toggle-assets">
          <i class="fas fa-layer-group"></i> 显示/隐藏资源
        </button>
      </div>
    `).join('');

    // 更新统计信息
    document.getElementById('release-count').textContent = releases.length;
    const totalFiles = releases.reduce((acc, release) => acc + release.assets.length, 0);
    document.getElementById('file-count').textContent = totalFiles;

    // 资源切换功能
    document.querySelectorAll('.toggle-assets').forEach(button => {
      button.addEventListener('click', function() {
        const assetsList = this.previousElementSibling;
        assetsList.style.display = assetsList.style.display === 'none' ? 'block' : 'none';
        this.innerHTML = assetsList.style.display === 'none' ? 
          '<i class="fas fa-layer-group"></i> 显示资源' : 
          '<i class="fas fa-layer-group"></i> 隐藏资源';
      });
    });
  } catch (error) {
    showErrorNotification(`文件加载失败: ${error.message}`);
  }
}

// 获取并显示讨论区
async function fetchDiscussions() {
  try {
    const response = await fetch(`https://api.github.com/repos/zzrcmd/YF-Cloud/issues`);
    const issues = await response.json();

    const container = document.getElementById('discussions');
    container.innerHTML = '';
    
    issues.forEach(issue => {
      const issueDiv = document.createElement('div');
      issueDiv.className = 'issue';
      issueDiv.innerHTML = `
        <div class="issue-header">
          <div class="user-info">
            <img src="${issue.user.avatar_url}" class="avatar" alt="${issue.user.login}">
            <div class="user-details">
              <div class="comment-author">${issue.user.login}</div>
              <div class="comment-date">${new Date(issue.created_at).toLocaleString()}</div>
            </div>
          </div>
          <h3><i class="fas fa-comment-dots"></i> ${issue.title}</h3>
          <p>${issue.body || '无内容描述'}</p>
          <button class="submit-button" onclick="loadComments(this, ${issue.number})"
            style="margin-top:15px;padding:10px 20px;">
            <i class="fas fa-comments"></i> 显示评论 (${issue.comments})
          </button>
        </div>
        <div class="comments-container" style="display:none;"></div>
      `;
      container.appendChild(issueDiv);
    });
  } catch (error) {
    console.error('获取讨论信息失败:', error);
    showErrorNotification('加载讨论失败，请稍后重试');
  }
}

// 加载评论
async function loadComments(button, issueNumber) {
  const container = button.parentElement.nextElementSibling;
  if (container.children.length === 0) {
    try {
      button.disabled = true;
      button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 加载中...';
      
      const response = await fetch(`https://api.github.com/repos/zzrcmd/YF-Cloud/issues/${issueNumber}/comments`);
      const comments = await response.json();
      
      container.innerHTML = comments.map(comment => `
        <div class="comment">
          <img src="${comment.user.avatar_url}" class="avatar" alt="${comment.user.login}">
          <div class="comment-content">
            <div class="user-info">
              <span class="comment-author">${comment.user.login}</span>
              <span class="comment-date">${new Date(comment.created_at).toLocaleString()}</span>
            </div>
            <div class="comment-body">${comment.body || '无评论内容'}</div>
          </div>
        </div>
      `).join('');
      
      button.innerHTML = `<i class="fas fa-comments"></i> 隐藏评论 (${comments.length})`;
    } catch (error) {
      console.error('获取评论失败:', error);
      container.innerHTML = '<div class="error-text"><i class="fas fa-exclamation-triangle"></i> 无法加载评论</div>';
      button.innerHTML = `<i class="fas fa-comments"></i> 显示评论 (${issueNumber})`;
    } finally {
      button.disabled = false;
    }
  }
  container.style.display = container.style.display === 'none' ? 'block' : 'none';
  button.innerHTML = container.style.display === 'none' ? 
    `<i class="fas fa-comments"></i> 显示评论 (${issueNumber})` : 
    `<i class="fas fa-comments"></i> 隐藏评论 (${issueNumber})`;
}

// 创建新Issue
function createNewIssue() {
  const titleInput = document.getElementById('issueTitle');
  const bodyInput = document.getElementById('issueBody');
  
  if (!titleInput.value.trim()) {
    titleInput.focus();
    titleInput.style.borderColor = '#e74c3c';
    setTimeout(() => titleInput.style.borderColor = '#e0e0e0', 2000);
    showErrorNotification('请填写讨论标题');
    return;
  }

  const baseUrl = `https://github.com/zzrcmd/YF-Cloud/issues/new`;
  const params = new URLSearchParams({
    title: titleInput.value.trim(),
    body: bodyInput.value.trim(),
    labels: 'user-generated'
  });

  const newWindow = window.open(`${baseUrl}?${params.toString()}`, '_blank');
  
  if (newWindow) {
    titleInput.value = '';
    bodyInput.value = '';
    showSuccessNotification('讨论创建成功！请在GitHub页面完成提交');
  }
}

// 工具函数
function escapeHtml(unsafe) {
  return unsafe.toString()
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#039;");
}

function generateProxyUrl(url) {
  return `https://ghproxy.net/${encodeURI(url)}`;
}

function formatFileSize(bytes) {
  const units = ['Bytes', 'KB', 'MB', 'GB'];
  if (bytes == 0) return '0 Bytes';
  const exp = Math.floor(Math.log(bytes) / Math.log(1024));
  return `${(bytes / Math.pow(1024, exp)).toFixed(2)} ${units[exp]}`;
}

// 错误提示功能
function showErrorNotification(message) {
  const notification = document.createElement('div');
  notification.className = 'error-notification';
  notification.innerHTML = `
    <div class="error-content">
      <span><i class="fas fa-exclamation-circle"></i> ${escapeHtml(message)}</span>
      <button class="close-button"><i class="fas fa-times"></i></button>
    </div>
  `;
  document.body.appendChild(notification);
  notification.querySelector('.close-button').onclick = () => notification.remove();
  setTimeout(() => notification.remove(), 5000);
  
  // 样式
  notification.style.position = 'fixed';
  notification.style.bottom = '20px';
  notification.style.right = '20px';
  notification.style.backgroundColor = '#ffebee';
  notification.style.color = '#c62828';
  notification.style.padding = '15px 25px';
  notification.style.borderRadius = '8px';
  notification.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
  notification.style.zIndex = '10000';
  notification.style.display = 'flex';
  notification.style.alignItems = 'center';
  notification.style.gap = '10px';
  
  const closeBtn = notification.querySelector('.close-button');
  closeBtn.style.background = 'none';
  closeBtn.style.border = 'none';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.color = '#c62828';
  closeBtn.style.fontSize = '1.2rem';
}

function showSuccessNotification(message) {
  const notification = document.createElement('div');
  notification.className = 'success-notification';
  notification.innerHTML = `
    <div class="success-content">
      <span><i class="fas fa-check-circle"></i> ${escapeHtml(message)}</span>
      <button class="close-button"><i class="fas fa-times"></i></button>
    </div>
  `;
  document.body.appendChild(notification);
  notification.querySelector('.close-button').onclick = () => notification.remove();
  setTimeout(() => notification.remove(), 5000);
  
  // 样式
  notification.style.position = 'fixed';
  notification.style.bottom = '20px';
  notification.style.right = '20px';
  notification.style.backgroundColor = '#e8f5e9';
  notification.style.color = '#2e7d32';
  notification.style.padding = '15px 25px';
  notification.style.borderRadius = '8px';
  notification.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
  notification.style.zIndex = '10000';
  notification.style.display = 'flex';
  notification.style.alignItems = 'center';
  notification.style.gap = '10px';
  
  const closeBtn = notification.querySelector('.close-button');
  closeBtn.style.background = 'none';
  closeBtn.style.border = 'none';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.color = '#2e7d32';
  closeBtn.style.fontSize = '1.2rem';
}

// 初始化
document.addEventListener('DOMContentLoaded', initialize);
  </script>
</body>
</html>
